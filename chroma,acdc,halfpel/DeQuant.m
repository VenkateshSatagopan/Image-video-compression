function [ block_out ] = DeQuant(block_in,q_factor, option)
%Dequantize the given block according to the given scalar quantization
%factor, and option index (intra or inter)
%   Inputs -->  block_in:     input block
%               q_factor:     scalar quantization factor
%               option:       if 1 -> intra quantization
%                             if 2 -> inter quantization
%
%   Outputs --> block_out:    output block

block_size = size(block_in, 1);

if option == 1
    if block_size == 4
        quant_matrix = 16*ones(4);
    elseif block_size == 8
        quant_matrix = [16 16 16 16 17 18 21 24;
                        16 16 16 16 17 19 22 25;
                        16 16 17 18 20 22 25 29;
                        16 16 18 21 24 27 31 36;
                        17 17 20 24 30 35 41 47;
                        18 19 22 27 35 44 54 65;
                        21 22 25 31 41 54 70 88;
                        24 25 29 36 47 65 88 115];
    elseif block_size == 16
        quant_matrix = [16 16 16 16 16 16 16 16 17 17 18 18 21 21 24 24;
                        16 16 16 16 16 16 16 16 17 17 18 18 21 21 24 24;
                        16 16 16 16 16 16 16 16 17 17 19 19 22 22 25 25;
                        16 16 16 16 16 16 16 16 17 17 19 19 22 22 25 25;
                        16 16 16 16 17 17 18 18 20 20 22 22 25 25 29 29;
                        16 16 16 16 17 17 18 18 20 20 22 22 25 25 29 29;
                        16 16 16 16 18 18 21 21 24 24 27 27 31 31 36 36;
                        16 16 16 16 18 18 21 21 24 24 27 27 31 31 36 36;
                        17 17 17 17 20 20 24 24 30 30 35 35 41 41 47 47;
                        17 17 17 17 20 20 24 24 30 30 35 35 41 41 47 47;
                        18 18 19 19 22 22 27 27 35 35 44 44 54 54 65 65;
                        18 18 19 19 22 22 27 27 35 35 44 44 54 54 65 65;
                        21 21 22 22 25 25 31 31 41 41 54 54 70 70 88 88;
                        21 21 22 22 25 25 31 31 41 41 54 54 70 70 88 88;
                        24 24 25 25 29 29 36 36 47 47 65 65 88 88 115 115
                        24 24 25 25 29 29 36 36 47 47 65 65 88 88 115 115];
    elseif block_size == 32
        quant_matrix = [16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 18 18 18 18 21 21 21 21 24 24 24 24;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 18 18 18 18 21 21 21 21 24 24 24 24;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 18 18 18 18 21 21 21 21 24 24 24 24;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 18 18 18 18 21 21 21 21 24 24 24 24;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 19 19 19 19 22 22 22 22 25 25 25 25;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 19 19 19 19 22 22 22 22 25 25 25 25;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 19 19 19 19 22 22 22 22 25 25 25 25;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 19 19 19 19 22 22 22 22 25 25 25 25;
                        16 16 16 16 16 16 16 16 17 17 17 17 18 18 18 18 20 20 20 20 22 22 22 22 25 25 25 25 29 29 29 29;
                        16 16 16 16 16 16 16 16 17 17 17 17 18 18 18 18 20 20 20 20 22 22 22 22 25 25 25 25 29 29 29 29;
                        16 16 16 16 16 16 16 16 17 17 17 17 18 18 18 18 20 20 20 20 22 22 22 22 25 25 25 25 29 29 29 29;
                        16 16 16 16 16 16 16 16 17 17 17 17 18 18 18 18 20 20 20 20 22 22 22 22 25 25 25 25 29 29 29 29;
                        16 16 16 16 16 16 16 16 18 18 18 18 21 21 21 21 24 24 24 24 27 27 27 27 31 31 31 31 36 36 36 36;
                        16 16 16 16 16 16 16 16 18 18 18 18 21 21 21 21 24 24 24 24 27 27 27 27 31 31 31 31 36 36 36 36;
                        16 16 16 16 16 16 16 16 18 18 18 18 21 21 21 21 24 24 24 24 27 27 27 27 31 31 31 31 36 36 36 36;
                        16 16 16 16 16 16 16 16 18 18 18 18 21 21 21 21 24 24 24 24 27 27 27 27 31 31 31 31 36 36 36 36;
                        17 17 17 17 17 17 17 17 20 20 20 20 24 24 24 24 30 30 30 30 35 35 35 35 41 41 41 41 47 47 47 47;
                        17 17 17 17 17 17 17 17 20 20 20 20 24 24 24 24 30 30 30 30 35 35 35 35 41 41 41 41 47 47 47 47;
                        17 17 17 17 17 17 17 17 20 20 20 20 24 24 24 24 30 30 30 30 35 35 35 35 41 41 41 41 47 47 47 47;
                        17 17 17 17 17 17 17 17 20 20 20 20 24 24 24 24 30 30 30 30 35 35 35 35 41 41 41 41 47 47 47 47;
                        18 18 18 18 19 19 19 19 22 22 22 22 27 27 27 27 35 35 35 35 44 44 44 44 54 54 54 54 65 65 65 65;
                        18 18 18 18 19 19 19 19 22 22 22 22 27 27 27 27 35 35 35 35 44 44 44 44 54 54 54 54 65 65 65 65;
                        18 18 18 18 19 19 19 19 22 22 22 22 27 27 27 27 35 35 35 35 44 44 44 44 54 54 54 54 65 65 65 65;
                        18 18 18 18 19 19 19 19 22 22 22 22 27 27 27 27 35 35 35 35 44 44 44 44 54 54 54 54 65 65 65 65;
                        21 21 21 21 22 22 22 22 25 25 25 25 31 31 31 31 41 41 41 41 54 54 54 54 70 70 70 70 88 88 88 88;
                        21 21 21 21 22 22 22 22 25 25 25 25 31 31 31 31 41 41 41 41 54 54 54 54 70 70 70 70 88 88 88 88;
                        21 21 21 21 22 22 22 22 25 25 25 25 31 31 31 31 41 41 41 41 54 54 54 54 70 70 70 70 88 88 88 88;
                        21 21 21 21 22 22 22 22 25 25 25 25 31 31 31 31 41 41 41 41 54 54 54 54 70 70 70 70 88 88 88 88;
                        24 24 24 24 25 25 25 25 29 29 29 29 36 36 36 36 47 47 47 47 65 65 65 65 88 88 88 88 115 115 115 115;
                        24 24 24 24 25 25 25 25 29 29 29 29 36 36 36 36 47 47 47 47 65 65 65 65 88 88 88 88 115 115 115 115;
                        24 24 24 24 25 25 25 25 29 29 29 29 36 36 36 36 47 47 47 47 65 65 65 65 88 88 88 88 115 115 115 115;
                        24 24 24 24 25 25 25 25 29 29 29 29 36 36 36 36 47 47 47 47 65 65 65 65 88 88 88 88 115 115 115 115];
    elseif block_size == 64
        quant_matrix = [16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 21 21 21 21 21 21 21 21 24 24 24 24 24 24 24 24;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 21 21 21 21 21 21 21 21 24 24 24 24 24 24 24 24;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 21 21 21 21 21 21 21 21 24 24 24 24 24 24 24 24;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 21 21 21 21 21 21 21 21 24 24 24 24 24 24 24 24;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 21 21 21 21 21 21 21 21 24 24 24 24 24 24 24 24;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 21 21 21 21 21 21 21 21 24 24 24 24 24 24 24 24;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 21 21 21 21 21 21 21 21 24 24 24 24 24 24 24 24;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 21 21 21 21 21 21 21 21 24 24 24 24 24 24 24 24;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 19 19 19 19 19 19 19 19 22 22 22 22 22 22 22 22 25 25 25 25 25 25 25 25;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 19 19 19 19 19 19 19 19 22 22 22 22 22 22 22 22 25 25 25 25 25 25 25 25;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 19 19 19 19 19 19 19 19 22 22 22 22 22 22 22 22 25 25 25 25 25 25 25 25;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 19 19 19 19 19 19 19 19 22 22 22 22 22 22 22 22 25 25 25 25 25 25 25 25;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 19 19 19 19 19 19 19 19 22 22 22 22 22 22 22 22 25 25 25 25 25 25 25 25;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 19 19 19 19 19 19 19 19 22 22 22 22 22 22 22 22 25 25 25 25 25 25 25 25;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 19 19 19 19 19 19 19 19 22 22 22 22 22 22 22 22 25 25 25 25 25 25 25 25;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 19 19 19 19 19 19 19 19 22 22 22 22 22 22 22 22 25 25 25 25 25 25 25 25;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 22 22 22 22 22 22 22 22 25 25 25 25 25 25 25 25 29 29 29 29 29 29 29 29;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 22 22 22 22 22 22 22 22 25 25 25 25 25 25 25 25 29 29 29 29 29 29 29 29;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 22 22 22 22 22 22 22 22 25 25 25 25 25 25 25 25 29 29 29 29 29 29 29 29;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 22 22 22 22 22 22 22 22 25 25 25 25 25 25 25 25 29 29 29 29 29 29 29 29;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 22 22 22 22 22 22 22 22 25 25 25 25 25 25 25 25 29 29 29 29 29 29 29 29;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 22 22 22 22 22 22 22 22 25 25 25 25 25 25 25 25 29 29 29 29 29 29 29 29;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 22 22 22 22 22 22 22 22 25 25 25 25 25 25 25 25 29 29 29 29 29 29 29 29;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 22 22 22 22 22 22 22 22 25 25 25 25 25 25 25 25 29 29 29 29 29 29 29 29;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 18 18 18 18 18 18 18 18 21 21 21 21 21 21 21 21 24 24 24 24 24 24 24 24 27 27 27 27 27 27 27 27 31 31 31 31 31 31 31 31 36 36 36 36 36 36 36 36;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 18 18 18 18 18 18 18 18 21 21 21 21 21 21 21 21 24 24 24 24 24 24 24 24 27 27 27 27 27 27 27 27 31 31 31 31 31 31 31 31 36 36 36 36 36 36 36 36;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 18 18 18 18 18 18 18 18 21 21 21 21 21 21 21 21 24 24 24 24 24 24 24 24 27 27 27 27 27 27 27 27 31 31 31 31 31 31 31 31 36 36 36 36 36 36 36 36;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 18 18 18 18 18 18 18 18 21 21 21 21 21 21 21 21 24 24 24 24 24 24 24 24 27 27 27 27 27 27 27 27 31 31 31 31 31 31 31 31 36 36 36 36 36 36 36 36;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 18 18 18 18 18 18 18 18 21 21 21 21 21 21 21 21 24 24 24 24 24 24 24 24 27 27 27 27 27 27 27 27 31 31 31 31 31 31 31 31 36 36 36 36 36 36 36 36;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 18 18 18 18 18 18 18 18 21 21 21 21 21 21 21 21 24 24 24 24 24 24 24 24 27 27 27 27 27 27 27 27 31 31 31 31 31 31 31 31 36 36 36 36 36 36 36 36;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 18 18 18 18 18 18 18 18 21 21 21 21 21 21 21 21 24 24 24 24 24 24 24 24 27 27 27 27 27 27 27 27 31 31 31 31 31 31 31 31 36 36 36 36 36 36 36 36;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 18 18 18 18 18 18 18 18 21 21 21 21 21 21 21 21 24 24 24 24 24 24 24 24 27 27 27 27 27 27 27 27 31 31 31 31 31 31 31 31 36 36 36 36 36 36 36 36;
                        17 17 17 17 17 17 17 17 17 17 17 17 17 17 17 17 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 30 30 30 30 30 30 30 30 35 35 35 35 35 35 35 35 41 41 41 41 41 41 41 41 47 47 47 47 47 47 47 47;
                        17 17 17 17 17 17 17 17 17 17 17 17 17 17 17 17 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 30 30 30 30 30 30 30 30 35 35 35 35 35 35 35 35 41 41 41 41 41 41 41 41 47 47 47 47 47 47 47 47;
                        17 17 17 17 17 17 17 17 17 17 17 17 17 17 17 17 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 30 30 30 30 30 30 30 30 35 35 35 35 35 35 35 35 41 41 41 41 41 41 41 41 47 47 47 47 47 47 47 47;
                        17 17 17 17 17 17 17 17 17 17 17 17 17 17 17 17 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 30 30 30 30 30 30 30 30 35 35 35 35 35 35 35 35 41 41 41 41 41 41 41 41 47 47 47 47 47 47 47 47;
                        17 17 17 17 17 17 17 17 17 17 17 17 17 17 17 17 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 30 30 30 30 30 30 30 30 35 35 35 35 35 35 35 35 41 41 41 41 41 41 41 41 47 47 47 47 47 47 47 47;
                        17 17 17 17 17 17 17 17 17 17 17 17 17 17 17 17 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 30 30 30 30 30 30 30 30 35 35 35 35 35 35 35 35 41 41 41 41 41 41 41 41 47 47 47 47 47 47 47 47;
                        17 17 17 17 17 17 17 17 17 17 17 17 17 17 17 17 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 30 30 30 30 30 30 30 30 35 35 35 35 35 35 35 35 41 41 41 41 41 41 41 41 47 47 47 47 47 47 47 47;
                        17 17 17 17 17 17 17 17 17 17 17 17 17 17 17 17 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 30 30 30 30 30 30 30 30 35 35 35 35 35 35 35 35 41 41 41 41 41 41 41 41 47 47 47 47 47 47 47 47;
                        18 18 18 18 18 18 18 18 19 19 19 19 19 19 19 19 22 22 22 22 22 22 22 22 27 27 27 27 27 27 27 27 35 35 35 35 35 35 35 35 44 44 44 44 44 44 44 44 54 54 54 54 54 54 54 54 65 65 65 65 65 65 65 65;
                        18 18 18 18 18 18 18 18 19 19 19 19 19 19 19 19 22 22 22 22 22 22 22 22 27 27 27 27 27 27 27 27 35 35 35 35 35 35 35 35 44 44 44 44 44 44 44 44 54 54 54 54 54 54 54 54 65 65 65 65 65 65 65 65;
                        18 18 18 18 18 18 18 18 19 19 19 19 19 19 19 19 22 22 22 22 22 22 22 22 27 27 27 27 27 27 27 27 35 35 35 35 35 35 35 35 44 44 44 44 44 44 44 44 54 54 54 54 54 54 54 54 65 65 65 65 65 65 65 65;
                        18 18 18 18 18 18 18 18 19 19 19 19 19 19 19 19 22 22 22 22 22 22 22 22 27 27 27 27 27 27 27 27 35 35 35 35 35 35 35 35 44 44 44 44 44 44 44 44 54 54 54 54 54 54 54 54 65 65 65 65 65 65 65 65;
                        18 18 18 18 18 18 18 18 19 19 19 19 19 19 19 19 22 22 22 22 22 22 22 22 27 27 27 27 27 27 27 27 35 35 35 35 35 35 35 35 44 44 44 44 44 44 44 44 54 54 54 54 54 54 54 54 65 65 65 65 65 65 65 65;
                        18 18 18 18 18 18 18 18 19 19 19 19 19 19 19 19 22 22 22 22 22 22 22 22 27 27 27 27 27 27 27 27 35 35 35 35 35 35 35 35 44 44 44 44 44 44 44 44 54 54 54 54 54 54 54 54 65 65 65 65 65 65 65 65;
                        18 18 18 18 18 18 18 18 19 19 19 19 19 19 19 19 22 22 22 22 22 22 22 22 27 27 27 27 27 27 27 27 35 35 35 35 35 35 35 35 44 44 44 44 44 44 44 44 54 54 54 54 54 54 54 54 65 65 65 65 65 65 65 65;
                        18 18 18 18 18 18 18 18 19 19 19 19 19 19 19 19 22 22 22 22 22 22 22 22 27 27 27 27 27 27 27 27 35 35 35 35 35 35 35 35 44 44 44 44 44 44 44 44 54 54 54 54 54 54 54 54 65 65 65 65 65 65 65 65;
                        21 21 21 21 21 21 21 21 22 22 22 22 22 22 22 22 25 25 25 25 25 25 25 25 31 31 31 31 31 31 31 31 41 41 41 41 41 41 41 41 54 54 54 54 54 54 54 54 70 70 70 70 70 70 70 70 88 88 88 88 88 88 88 88;
                        21 21 21 21 21 21 21 21 22 22 22 22 22 22 22 22 25 25 25 25 25 25 25 25 31 31 31 31 31 31 31 31 41 41 41 41 41 41 41 41 54 54 54 54 54 54 54 54 70 70 70 70 70 70 70 70 88 88 88 88 88 88 88 88;
                        21 21 21 21 21 21 21 21 22 22 22 22 22 22 22 22 25 25 25 25 25 25 25 25 31 31 31 31 31 31 31 31 41 41 41 41 41 41 41 41 54 54 54 54 54 54 54 54 70 70 70 70 70 70 70 70 88 88 88 88 88 88 88 88;
                        21 21 21 21 21 21 21 21 22 22 22 22 22 22 22 22 25 25 25 25 25 25 25 25 31 31 31 31 31 31 31 31 41 41 41 41 41 41 41 41 54 54 54 54 54 54 54 54 70 70 70 70 70 70 70 70 88 88 88 88 88 88 88 88;
                        21 21 21 21 21 21 21 21 22 22 22 22 22 22 22 22 25 25 25 25 25 25 25 25 31 31 31 31 31 31 31 31 41 41 41 41 41 41 41 41 54 54 54 54 54 54 54 54 70 70 70 70 70 70 70 70 88 88 88 88 88 88 88 88;
                        21 21 21 21 21 21 21 21 22 22 22 22 22 22 22 22 25 25 25 25 25 25 25 25 31 31 31 31 31 31 31 31 41 41 41 41 41 41 41 41 54 54 54 54 54 54 54 54 70 70 70 70 70 70 70 70 88 88 88 88 88 88 88 88;
                        21 21 21 21 21 21 21 21 22 22 22 22 22 22 22 22 25 25 25 25 25 25 25 25 31 31 31 31 31 31 31 31 41 41 41 41 41 41 41 41 54 54 54 54 54 54 54 54 70 70 70 70 70 70 70 70 88 88 88 88 88 88 88 88;
                        21 21 21 21 21 21 21 21 22 22 22 22 22 22 22 22 25 25 25 25 25 25 25 25 31 31 31 31 31 31 31 31 41 41 41 41 41 41 41 41 54 54 54 54 54 54 54 54 70 70 70 70 70 70 70 70 88 88 88 88 88 88 88 88;
                        24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 29 29 29 29 29 29 29 29 36 36 36 36 36 36 36 36 47 47 47 47 47 47 47 47 65 65 65 65 65 65 65 65 88 88 88 88 88 88 88 88 115 115 115 115 115 115 115 115;
                        24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 29 29 29 29 29 29 29 29 36 36 36 36 36 36 36 36 47 47 47 47 47 47 47 47 65 65 65 65 65 65 65 65 88 88 88 88 88 88 88 88 115 115 115 115 115 115 115 115;
                        24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 29 29 29 29 29 29 29 29 36 36 36 36 36 36 36 36 47 47 47 47 47 47 47 47 65 65 65 65 65 65 65 65 88 88 88 88 88 88 88 88 115 115 115 115 115 115 115 115;
                        24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 29 29 29 29 29 29 29 29 36 36 36 36 36 36 36 36 47 47 47 47 47 47 47 47 65 65 65 65 65 65 65 65 88 88 88 88 88 88 88 88 115 115 115 115 115 115 115 115;
                        24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 29 29 29 29 29 29 29 29 36 36 36 36 36 36 36 36 47 47 47 47 47 47 47 47 65 65 65 65 65 65 65 65 88 88 88 88 88 88 88 88 115 115 115 115 115 115 115 115;
                        24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 29 29 29 29 29 29 29 29 36 36 36 36 36 36 36 36 47 47 47 47 47 47 47 47 65 65 65 65 65 65 65 65 88 88 88 88 88 88 88 88 115 115 115 115 115 115 115 115;
                        24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 29 29 29 29 29 29 29 29 36 36 36 36 36 36 36 36 47 47 47 47 47 47 47 47 65 65 65 65 65 65 65 65 88 88 88 88 88 88 88 88 115 115 115 115 115 115 115 115;
                        24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 29 29 29 29 29 29 29 29 36 36 36 36 36 36 36 36 47 47 47 47 47 47 47 47 65 65 65 65 65 65 65 65 88 88 88 88 88 88 88 88 115 115 115 115 115 115 115 115];
    end
elseif option == 2
    if block_size == 4
        quant_matrix = 16*ones(4);
    elseif block_size == 8
        quant_matrix = [16 16 16 16 17 18 20 24;
                        16 16 16 17 18 20 24 25;
                        16 16 17 18 20 24 25 28;
                        16 17 18 20 24 25 28 33;
                        17 18 20 24 25 28 33 41;
                        18 20 24 25 28 33 41 54;
                        20 24 25 28 33 41 54 71;
                        24 25 28 33 41 54 71 91];
    elseif block_size == 16
        quant_matrix = [16 16 16 16 16 16 16 16 17 17 18 18 20 20 24 24;
                        16 16 16 16 16 16 16 16 17 17 18 18 20 20 24 24;
                        16 16 16 16 16 16 17 17 18 18 20 20 24 24 25 25;
                        16 16 16 16 16 16 17 17 18 18 20 20 24 24 25 25;
                        16 16 16 16 17 17 18 18 20 20 24 24 25 25 28 28;
                        16 16 16 16 17 17 18 18 20 20 24 24 25 25 28 28;
                        16 16 17 17 18 18 20 20 24 24 25 25 28 28 33 33;
                        16 16 17 17 18 18 20 20 24 24 25 25 28 28 33 33;
                        17 17 18 18 20 20 24 24 25 25 28 28 33 33 41 41;
                        17 17 18 18 20 20 24 24 25 25 28 28 33 33 41 41;
                        18 18 20 20 24 24 25 25 28 28 33 33 41 41 54 54;
                        18 18 20 20 24 24 25 25 28 28 33 33 41 41 54 54;
                        20 20 24 24 25 25 28 28 33 33 41 41 54 54 71 71;
                        20 20 24 24 25 25 28 28 33 33 41 41 54 54 71 71;
                        24 24 25 25 28 28 33 33 41 41 54 54 71 71 91 91;
                        24 24 25 25 28 28 33 33 41 41 54 54 71 71 91 91];
    elseif block_size == 32
        quant_matrix = [16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 18 18 18 18 20 20 20 20 24 24 24 24;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 18 18 18 18 20 20 20 20 24 24 24 24;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 18 18 18 18 20 20 20 20 24 24 24 24;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 18 18 18 18 20 20 20 20 24 24 24 24;
                        16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 18 18 18 18 20 20 20 20 24 24 24 24 25 25 25 25;
                        16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 18 18 18 18 20 20 20 20 24 24 24 24 25 25 25 25;
                        16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 18 18 18 18 20 20 20 20 24 24 24 24 25 25 25 25;
                        16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 18 18 18 18 20 20 20 20 24 24 24 24 25 25 25 25;
                        16 16 16 16 16 16 16 16 17 17 17 17 18 18 18 18 20 20 20 20 24 24 24 24 25 25 25 25 28 28 28 28;
                        16 16 16 16 16 16 16 16 17 17 17 17 18 18 18 18 20 20 20 20 24 24 24 24 25 25 25 25 28 28 28 28;
                        16 16 16 16 16 16 16 16 17 17 17 17 18 18 18 18 20 20 20 20 24 24 24 24 25 25 25 25 28 28 28 28;
                        16 16 16 16 16 16 16 16 17 17 17 17 18 18 18 18 20 20 20 20 24 24 24 24 25 25 25 25 28 28 28 28;
                        16 16 16 16 17 17 17 17 18 18 18 18 20 20 20 20 24 24 24 24 25 25 25 25 28 28 28 28 33 33 33 33;
                        16 16 16 16 17 17 17 17 18 18 18 18 20 20 20 20 24 24 24 24 25 25 25 25 28 28 28 28 33 33 33 33;
                        16 16 16 16 17 17 17 17 18 18 18 18 20 20 20 20 24 24 24 24 25 25 25 25 28 28 28 28 33 33 33 33;
                        16 16 16 16 17 17 17 17 18 18 18 18 20 20 20 20 24 24 24 24 25 25 25 25 28 28 28 28 33 33 33 33;
                        17 17 17 17 18 18 18 18 20 20 20 20 24 24 24 24 25 25 25 25 28 28 28 28 33 33 33 33 41 41 41 41;
                        17 17 17 17 18 18 18 18 20 20 20 20 24 24 24 24 25 25 25 25 28 28 28 28 33 33 33 33 41 41 41 41;
                        17 17 17 17 18 18 18 18 20 20 20 20 24 24 24 24 25 25 25 25 28 28 28 28 33 33 33 33 41 41 41 41;
                        17 17 17 17 18 18 18 18 20 20 20 20 24 24 24 24 25 25 25 25 28 28 28 28 33 33 33 33 41 41 41 41;
                        18 18 18 18 20 20 20 20 24 24 24 24 25 25 25 25 28 28 28 28 33 33 33 33 41 41 41 41 54 54 54 54;
                        18 18 18 18 20 20 20 20 24 24 24 24 25 25 25 25 28 28 28 28 33 33 33 33 41 41 41 41 54 54 54 54;
                        18 18 18 18 20 20 20 20 24 24 24 24 25 25 25 25 28 28 28 28 33 33 33 33 41 41 41 41 54 54 54 54;
                        18 18 18 18 20 20 20 20 24 24 24 24 25 25 25 25 28 28 28 28 33 33 33 33 41 41 41 41 54 54 54 54;
                        20 20 20 20 24 24 24 24 25 25 25 25 28 28 28 28 33 33 33 33 41 41 41 41 54 54 54 54 71 71 71 71;
                        20 20 20 20 24 24 24 24 25 25 25 25 28 28 28 28 33 33 33 33 41 41 41 41 54 54 54 54 71 71 71 71;
                        20 20 20 20 24 24 24 24 25 25 25 25 28 28 28 28 33 33 33 33 41 41 41 41 54 54 54 54 71 71 71 71;
                        20 20 20 20 24 24 24 24 25 25 25 25 28 28 28 28 33 33 33 33 41 41 41 41 54 54 54 54 71 71 71 71;
                        24 24 24 24 25 25 25 25 28 28 28 28 33 33 33 33 41 41 41 41 54 54 54 54 71 71 71 71 91 91 91 91;
                        24 24 24 24 25 25 25 25 28 28 28 28 33 33 33 33 41 41 41 41 54 54 54 54 71 71 71 71 91 91 91 91;
                        24 24 24 24 25 25 25 25 28 28 28 28 33 33 33 33 41 41 41 41 54 54 54 54 71 71 71 71 91 91 91 91;
                        24 24 24 24 25 25 25 25 28 28 28 28 33 33 33 33 41 41 41 41 54 54 54 54 71 71 71 71 91 91 91 91];
    elseif block_size == 64
        quant_matrix = [16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28;
                        16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28;
                        16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28 33 33 33 33 33 33 33 33;
                        16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28 33 33 33 33 33 33 33 33;
                        16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28 33 33 33 33 33 33 33 33;
                        16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28 33 33 33 33 33 33 33 33;
                        16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28 33 33 33 33 33 33 33 33;
                        16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28 33 33 33 33 33 33 33 33;
                        16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28 33 33 33 33 33 33 33 33;
                        16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28 33 33 33 33 33 33 33 33;
                        17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28 33 33 33 33 33 33 33 33 41 41 41 41 41 41 41 41;
                        17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28 33 33 33 33 33 33 33 33 41 41 41 41 41 41 41 41;
                        17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28 33 33 33 33 33 33 33 33 41 41 41 41 41 41 41 41;
                        17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28 33 33 33 33 33 33 33 33 41 41 41 41 41 41 41 41;
                        17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28 33 33 33 33 33 33 33 33 41 41 41 41 41 41 41 41;
                        17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28 33 33 33 33 33 33 33 33 41 41 41 41 41 41 41 41;
                        17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28 33 33 33 33 33 33 33 33 41 41 41 41 41 41 41 41;
                        17 17 17 17 17 17 17 17 18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28 33 33 33 33 33 33 33 33 41 41 41 41 41 41 41 41;
                        18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28 33 33 33 33 33 33 33 33 41 41 41 41 41 41 41 41 54 54 54 54 54 54 54 54;
                        18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28 33 33 33 33 33 33 33 33 41 41 41 41 41 41 41 41 54 54 54 54 54 54 54 54;
                        18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28 33 33 33 33 33 33 33 33 41 41 41 41 41 41 41 41 54 54 54 54 54 54 54 54;
                        18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28 33 33 33 33 33 33 33 33 41 41 41 41 41 41 41 41 54 54 54 54 54 54 54 54;
                        18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28 33 33 33 33 33 33 33 33 41 41 41 41 41 41 41 41 54 54 54 54 54 54 54 54;
                        18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28 33 33 33 33 33 33 33 33 41 41 41 41 41 41 41 41 54 54 54 54 54 54 54 54;
                        18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28 33 33 33 33 33 33 33 33 41 41 41 41 41 41 41 41 54 54 54 54 54 54 54 54;
                        18 18 18 18 18 18 18 18 20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28 33 33 33 33 33 33 33 33 41 41 41 41 41 41 41 41 54 54 54 54 54 54 54 54;
                        20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28 33 33 33 33 33 33 33 33 41 41 41 41 41 41 41 41 54 54 54 54 54 54 54 54 71 71 71 71 71 71 71 71;
                        20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28 33 33 33 33 33 33 33 33 41 41 41 41 41 41 41 41 54 54 54 54 54 54 54 54 71 71 71 71 71 71 71 71;
                        20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28 33 33 33 33 33 33 33 33 41 41 41 41 41 41 41 41 54 54 54 54 54 54 54 54 71 71 71 71 71 71 71 71;
                        20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28 33 33 33 33 33 33 33 33 41 41 41 41 41 41 41 41 54 54 54 54 54 54 54 54 71 71 71 71 71 71 71 71;
                        20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28 33 33 33 33 33 33 33 33 41 41 41 41 41 41 41 41 54 54 54 54 54 54 54 54 71 71 71 71 71 71 71 71;
                        20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28 33 33 33 33 33 33 33 33 41 41 41 41 41 41 41 41 54 54 54 54 54 54 54 54 71 71 71 71 71 71 71 71;
                        20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28 33 33 33 33 33 33 33 33 41 41 41 41 41 41 41 41 54 54 54 54 54 54 54 54 71 71 71 71 71 71 71 71;
                        20 20 20 20 20 20 20 20 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28 33 33 33 33 33 33 33 33 41 41 41 41 41 41 41 41 54 54 54 54 54 54 54 54 71 71 71 71 71 71 71 71;
                        24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28 33 33 33 33 33 33 33 33 41 41 41 41 41 41 41 41 54 54 54 54 54 54 54 54 71 71 71 71 71 71 71 71 91 91 91 91 91 91 91 91;
                        24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28 33 33 33 33 33 33 33 33 41 41 41 41 41 41 41 41 54 54 54 54 54 54 54 54 71 71 71 71 71 71 71 71 91 91 91 91 91 91 91 91;
                        24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28 33 33 33 33 33 33 33 33 41 41 41 41 41 41 41 41 54 54 54 54 54 54 54 54 71 71 71 71 71 71 71 71 91 91 91 91 91 91 91 91;
                        24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28 33 33 33 33 33 33 33 33 41 41 41 41 41 41 41 41 54 54 54 54 54 54 54 54 71 71 71 71 71 71 71 71 91 91 91 91 91 91 91 91;
                        24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28 33 33 33 33 33 33 33 33 41 41 41 41 41 41 41 41 54 54 54 54 54 54 54 54 71 71 71 71 71 71 71 71 91 91 91 91 91 91 91 91;
                        24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28 33 33 33 33 33 33 33 33 41 41 41 41 41 41 41 41 54 54 54 54 54 54 54 54 71 71 71 71 71 71 71 71 91 91 91 91 91 91 91 91;
                        24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28 33 33 33 33 33 33 33 33 41 41 41 41 41 41 41 41 54 54 54 54 54 54 54 54 71 71 71 71 71 71 71 71 91 91 91 91 91 91 91 91;
                        24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 28 28 28 28 28 28 28 28 33 33 33 33 33 33 33 33 41 41 41 41 41 41 41 41 54 54 54 54 54 54 54 54 71 71 71 71 71 71 71 71 91 91 91 91 91 91 91 91];
    end
end

block_out = q_factor*block_in.*quant_matrix;
end